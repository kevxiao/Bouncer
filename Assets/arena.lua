-- puppet.lua
-- A simplified puppet without posable joints, but that
-- looks roughly humanoid.

rootnode = gr.node('root')
rootnode:rotate('y', -20.0)
rootnode:scale( 0.25, 0.25, 0.25 )
rootnode:translate(0.0, 0.0, -1.0)

black = gr.material({0.0, 0.0, 0.0}, {0.1, 0.1, 0.1}, 1)
blackeyes = gr.material({0.0, 0.0, 0.0}, {0.6, 0.6, 0.6}, 50)
white = gr.material({1.0, 1.0, 1.0}, {0.6, 0.6, 0.6}, 10)
whitefur = gr.material({1.0, 1.0, 1.0}, {0.1, 0.1, 0.1}, 50)
snow = gr.material({1.0, 1.0, 1.0}, {0.5, 0.5, 0.5}, 100)
skin = gr.material({1.0, 0.867, 0.431}, {0.1, 0.1, 0.1}, 5)
bodyblue = gr.material({0.259, 0.753, 1.0}, {0.1, 0.12, 0.2}, 10)
brown = gr.material({0.380, 0.294, 0.122}, {0.1, 0.1, 0.1}, 5)
redtop = gr.material({1, 0, 0}, {0.1, 0.1, 0.1}, 5)

lowerTorso = gr.mesh('sphere', 'lowerTorso')
rootnode:add_child(lowerTorso)
lowerTorso:set_material(bodyblue)
lowerTorso:scale(0.55, 0.5, 0.55)
lowerTorso:translate(0.0, -0.3, 0.0)

upperTorso = gr.mesh('sphere', 'upperTorso')
lowerTorso:add_child(upperTorso)
upperTorso:set_material(bodyblue)
upperTorso:scale(1/0.55, 1/0.5, 1/0.55)
upperTorso:scale(0.3, 0.5, 0.3)
upperTorso:translate(0.0, 0.6, 0.0)

neckJoint = gr.joint('neckJoint', {-15, 0, 15}, {-20, 0, 20})
upperTorso:add_child(neckJoint)
neckJoint:scale(1/0.3, 1/0.5, 1/0.3)
neckJoint:translate(0.0, 0.9 , 0.0)

neck = gr.mesh('sphere', 'neck')
neckJoint:add_child(neck)
neck:scale(0.1, 0.15, 0.1)
neck:rotate('x', 45)
neck:translate(0.0, 0.1 , 0.1)
neck:set_material(bodyblue)

head = gr.mesh('sphere', 'head')
neckJoint:add_child(head)
head:scale(0.2, 0.2, 0.15)
head:translate(0.0, 0.05, 0.2)
head:set_material(bodyblue)

face = gr.mesh('sphere', 'face')
neckJoint:add_child(face)
face:scale(0.1, 0.1, 0.05)
face:translate(0.0, 0.06, 0.32)
face:set_material(skin)

nose = gr.mesh('sphere', 'nose')
face:add_child(nose)
nose:scale(0.1, 0.1, 0.1)
nose:translate(0.0, 0, 1)
nose:set_material(skin)

mouth = gr.mesh('sphere', 'mouth')
face:add_child(mouth)
mouth:scale(0.45, 0.5, 0.25)
mouth:rotate('x', 35)
mouth:translate(0.0, -0.5, 0.9)
mouth:set_material(skin)

mouthline1 = gr.mesh('sphere', 'mouthline1')
mouth:add_child(mouthline1)
mouthline1:scale(0.06, 0.7, 0.3)
mouthline1:translate(0.0, 0.3, 0.8)
mouthline1:set_material(black)

mouthline2 = gr.mesh('sphere', 'mouthline2')
mouth:add_child(mouthline2)
mouthline2:scale(1, 0.06, 0.3)
mouthline2:translate(0.0, -0.2, 0.8)
mouthline2:set_material(black)

eyel = gr.mesh('sphere', 'eyel')
face:add_child(eyel)
eyel:scale(0.2, 0.1, 0.1)
eyel:rotate('z', 20)
eyel:translate(0.3, 0.2, 0.9)
eyel:set_material(white)

eyer = gr.mesh('sphere', 'eyer')
face:add_child(eyer)
eyer:scale(0.2, 0.1, 0.1)
eyer:rotate('z', -20)
eyer:translate(-0.3, 0.2, 0.9)
eyer:set_material(white)

lshoulder = gr.mesh('sphere', 'lshoulder')
upperTorso:add_child(lshoulder)
lshoulder:scale(1/0.3, 1/0.5, 1/0.3)
lshoulder:scale(0.3, 0.15, 0.25)
lshoulder:translate(0.5, 0.5 , 0.0)
lshoulder:set_material(bodyblue)

lshoulderJoint = gr.joint('lshoulderJoint', {-120, 30, 120}, {0, 0, 0})
lshoulder:add_child(lshoulderJoint)
lshoulderJoint:scale(1/0.3, 1/0.15, 1/0.25)
lshoulderJoint:translate(0.45, 0.0 , 0.0)

lupperArm = gr.mesh('sphere', 'lupperArm')
lshoulderJoint:add_child(lupperArm)
lupperArm:scale(0.1, 0.3, 0.1)
lupperArm:rotate('z', 50)
lupperArm:translate(0.3, -0.12, 0.0)
lupperArm:set_material(bodyblue)

lelbowJoint = gr.joint('lelbowJoint', {-90, 30, 90}, {0, 0, 0})
lupperArm:add_child(lelbowJoint)
lelbowJoint:rotate('z', -50)
lelbowJoint:scale(1/0.1, 1/0.3, 1/0.1)
lelbowJoint:translate(-1.1, -0.1, 0.0)

lforeArm = gr.mesh('sphere', 'lforeArm')
lelbowJoint:add_child(lforeArm)
lforeArm:scale(0.2, 0.2, 0.3)
lforeArm:translate(0.2, 0.0, 0.25)
lforeArm:set_material(bodyblue)

lwristJoint = gr.joint('lwristJoint', {-90, 0, 90}, {0, 0, 0})
lforeArm:add_child(lwristJoint)
lwristJoint:scale(1/0.2, 1/0.2, 1/0.3)
lwristJoint:rotate('z', -90)
lwristJoint:translate(0.0, 0.0, 1.0)

lhand = gr.mesh('sphere', 'lhand')
lwristJoint:add_child(lhand)
lhand:scale(0.2, 0.2, 0.2)
lhand:translate(0.0, 0.0, 0.1)
lhand:set_material(skin)

rshoulder = gr.mesh('sphere', 'rshoulder')
upperTorso:add_child(rshoulder)
rshoulder:scale(1/0.3, 1/0.5, 1/0.3)
rshoulder:scale(0.3, 0.15, 0.25)
rshoulder:translate(-0.5, 0.5 , 0.0)
rshoulder:set_material(bodyblue)

rshoulderJoint = gr.joint('rshoulderJoint', {-120, -30, 120}, {0, 0, 0})
rshoulder:add_child(rshoulderJoint)
rshoulderJoint:scale(1/0.3, 1/0.15, 1/0.25)
rshoulderJoint:translate(-0.45, 0.0 , 0.0)

rupperArm = gr.mesh('sphere', 'rupperArm')
rshoulderJoint:add_child(rupperArm)
rupperArm:scale(0.1, 0.3, 0.1)
rupperArm:rotate('z', -50)
rupperArm:translate(-0.3, -0.12, 0.0)
rupperArm:set_material(bodyblue)

relbowJoint = gr.joint('relbowJoint', {-90, 0, 90}, {0, 0, 0})
rupperArm:add_child(relbowJoint)
relbowJoint:rotate('z', 50)
relbowJoint:scale(1/0.1, 1/0.3, 1/0.1)
relbowJoint:translate(1.1, -0.1, 0.0)

rforeArm = gr.mesh('sphere', 'rforeArm')
relbowJoint:add_child(rforeArm)
rforeArm:scale(0.2, 0.2, 0.3)
rforeArm:translate(-0.2, 0.0, 0.25)
rforeArm:set_material(bodyblue)

rwristJoint = gr.joint('rwristJoint', {-90, 30, 90}, {0, 0, 0})
rforeArm:add_child(rwristJoint)
rwristJoint:scale(1/0.2, 1/0.2, 1/0.3)
rwristJoint:rotate('z', 90)
rwristJoint:translate(0.0, 0.0, 1.0)

rhand = gr.mesh('sphere', 'rhand')
rwristJoint:add_child(rhand)
rhand:scale(0.2, 0.2, 0.2)
rhand:translate(0.0, 0.0, 0.1)
rhand:set_material(skin)

lhipJoint = gr.joint('lhipJoint', {-60, -45, 15}, {0, 0, 0})
lowerTorso:add_child(lhipJoint)
lhipJoint:scale(1/0.55, 1/0.5, 1/0.55)
lhipJoint:translate(0.4, -0.8, 0.0)

lupperLeg = gr.mesh('sphere', 'lupperLeg')
lhipJoint:add_child(lupperLeg)
lupperLeg:scale(0.1, 0.15, 0.1)
lupperLeg:translate(0.0, -0.15, 0.0)
lupperLeg:set_material(bodyblue)

lkneeJoint = gr.joint('lkneeJoint', {0, 45, 90}, {0, 0, 0})
lupperLeg:add_child(lkneeJoint)
lkneeJoint:scale(1/0.1, 1/0.15, 1/0.1)
lkneeJoint:translate(0.2, -0.7, 0.0)

llowerLeg = gr.mesh('sphere', 'llowerLeg')
lkneeJoint:add_child(llowerLeg)
llowerLeg:scale(0.13, 0.18, 0.13)
llowerLeg:translate(0.0, -0.14, 0.0)
llowerLeg:set_material(bodyblue)

lankleJoint = gr.joint('lankleJoint', {-60, -15, 60}, {0, 0, 0})
llowerLeg:add_child(lankleJoint)
lankleJoint:scale(1/0.13, 1/0.18, 1/0.13)
lankleJoint:translate(0.2, -0.6, 0.0)

lfoot = gr.mesh('sphere', 'lfoot')
lankleJoint:add_child(lfoot)
lfoot:scale(0.18, 0.1, 0.25)
lfoot:translate(0.0, 0.0, 0.2)
lfoot:set_material(skin)

rhipJoint = gr.joint('rhipJoint', {-60, -15, 15}, {0, 0, 0})
lowerTorso:add_child(rhipJoint)
rhipJoint:scale(1/0.55, 1/0.5, 1/0.55)
rhipJoint:translate(-0.4, -0.8, 0.0)

rupperLeg = gr.mesh('sphere', 'rupperLeg')
rhipJoint:add_child(rupperLeg)
rupperLeg:scale(0.1, 0.15, 0.1)
rupperLeg:translate(0.0, -0.15, 0.0)
rupperLeg:set_material(bodyblue)

rkneeJoint = gr.joint('rkneeJoint', {0, 80, 90}, {0, 0, 0})
rupperLeg:add_child(rkneeJoint)
rkneeJoint:scale(1/0.1, 1/0.15, 1/0.1)
rkneeJoint:translate(-0.2, -0.7, 0.0)

rlowerLeg = gr.mesh('sphere', 'rlowerLeg')
rkneeJoint:add_child(rlowerLeg)
rlowerLeg:scale(0.13, 0.18, 0.13)
rlowerLeg:translate(0.0, -0.14, 0.0)
rlowerLeg:set_material(bodyblue)

rankleJoint = gr.joint('rankleJoint', {-60, -15, 60}, {0, 0, 0})
rlowerLeg:add_child(rankleJoint)
rankleJoint:scale(1/0.13, 1/0.18, 1/0.13)
rankleJoint:translate(-0.2, -0.6, 0.0)

rfoot = gr.mesh('sphere', 'rfoot')
rankleJoint:add_child(rfoot)
rfoot:scale(0.18, 0.1, 0.25)
rfoot:translate(0.0, 0.0, 0.2)
rfoot:set_material(skin)

backpack = gr.mesh('sphere', 'backpack')
upperTorso:add_child(backpack)
backpack:scale(1/0.3, 1/0.5, 1/0.3)
backpack:scale(0.2, 0.2, 0.2)
backpack:translate(0.0, 0.6, -0.7)
backpack:set_material(brown)

nunuJoint = gr.joint('nunuJoint', {-25, 15, 25}, {0, 0, 0})
backpack:add_child(nunuJoint)
nunuJoint:scale(1/0.2, 1/0.2, 1/0.2)
nunuJoint:translate(0.05, 0.5, 0.0)

nunuTorso = gr.mesh('sphere', 'nunuTorso')
nunuJoint:add_child(nunuTorso)
nunuTorso:scale(0.1, 0.15, 0.1)
nunuTorso:translate(0.0, 0.15, 0.0)
nunuTorso:set_material(redtop)

nunuHeadJoint = gr.joint('nunuHeadJoint', {-45, 0, 45}, {-90, 0, 90})
nunuTorso:add_child(nunuHeadJoint)
nunuHeadJoint:scale(1/0.1, 1/0.15, 1/0.1)
nunuHeadJoint:translate(0.0, 0.5, 0.0)

nunuHead = gr.mesh('sphere', 'nunuHead')
nunuHeadJoint:add_child(nunuHead)
nunuHead:scale(0.15, 0.15, 0.08)
nunuHead:translate(0.0, 0.15, 0.0)
nunuHead:set_material(whitefur)

nunuHood = gr.mesh('sphere', 'nunuHood')
nunuHeadJoint:add_child(nunuHood)
nunuHood:scale(0.1, 0.1, 0.12)
nunuHood:translate(0.0, 0.15, -0.06)
nunuHood:set_material(redtop)

nunuFace = gr.mesh('sphere', 'nunuFace')
nunuHead:add_child(nunuFace)
nunuFace:scale(0.6, 0.6, 0.5)
nunuFace:translate(0.0, 0.0, 0.8)
nunuFace:set_material(skin)

lNunuEye = gr.mesh('sphere', 'lNunuEye')
nunuFace:add_child(lNunuEye)
lNunuEye:scale(0.2, 0.1, 0.8)
lNunuEye:rotate('z', 20)
lNunuEye:translate(0.3, 0.3, 0.8)
lNunuEye:set_material(blackeyes)

rNunuEye = gr.mesh('sphere', 'rNunuEye')
nunuFace:add_child(rNunuEye)
rNunuEye:scale(0.2, 0.1, 0.8)
rNunuEye:rotate('z', -20)
rNunuEye:translate(-0.3, 0.3, 0.8)
rNunuEye:set_material(blackeyes)

lNunuMouth = gr.mesh('sphere', 'lNunuMouth')
nunuFace:add_child(lNunuMouth)
lNunuMouth:scale(0.3, 0.04, 0.8)
lNunuMouth:rotate('z', 10)
lNunuMouth:translate(0.25, -0.2, 0.8)
lNunuMouth:set_material(black)

rNunuMouth = gr.mesh('sphere', 'rNunuMouth')
nunuFace:add_child(rNunuMouth)
rNunuMouth:scale(0.3, 0.04, 0.8)
rNunuMouth:rotate('z', -10)
rNunuMouth:translate(-0.25, -0.2, 0.8)
rNunuMouth:set_material(black)

lNunuShoulderJoint = gr.joint('lNunuShoulderJoint', {-20, 20, 40}, {0, 0, 0})
nunuTorso:add_child(lNunuShoulderJoint)
lNunuShoulderJoint:scale(1/0.1, 1/0.15, 1/0.1)
lNunuShoulderJoint:rotate('y', 90)
lNunuShoulderJoint:translate(0.25, 0.5, 0.0)

lNunuArm = gr.mesh('sphere', 'lNunuArm')
lNunuShoulderJoint:add_child(lNunuArm)
lNunuArm:scale(0.15, 0.03, 0.03)
lNunuArm:translate(0.1, 0.0, 0.0)
lNunuArm:rotate('y', -90)
lNunuArm:set_material(redtop)

snowball = gr.mesh('sphere', 'snowball')
lNunuArm:add_child(snowball)
snowball:scale(1/0.15, 1/0.03, 1/0.03)
snowball:scale(0.05, 0.05, 0.05)
snowball:translate(1, 1, 0.0)
snowball:set_material(snow)

rNunuShoulderJoint = gr.joint('rNunuShoulderJoint', {-20, 10, 40}, {0, 0, 0})
nunuTorso:add_child(rNunuShoulderJoint)
rNunuShoulderJoint:scale(1/0.1, 1/0.15, 1/0.1)
rNunuShoulderJoint:rotate('y', -90)
rNunuShoulderJoint:translate(-0.25, 0.5, 0.0)

rNunuArm = gr.mesh('sphere', 'rNunuArm')
rNunuShoulderJoint:add_child(rNunuArm)
rNunuArm:scale(0.15, 0.03, 0.03)
rNunuArm:translate(-0.1, 0.0, 0.0)
rNunuArm:rotate('y', 90)
rNunuArm:set_material(redtop)

return rootnode
